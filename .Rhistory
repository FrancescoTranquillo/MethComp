ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=sampleNum,
label=paste("[ ",
inf, sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
inf, sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]"sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ],", sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), "-",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-104, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-14, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")
scale_x_continuous(limits=c(-10,20))+
theme_dark()
theme_dark()
scale_x_continuous(limits=c(-10,20))+
theme_dark()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-14, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_light()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-14, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-18, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-16, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-4, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-4, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-10, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-4, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-10, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-6, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-10, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-10, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-11, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-10,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-11, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15 y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=2.5, hjust="inward")+
geom_text(aes(x=-10, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=4, hjust="inward")+
geom_text(aes(x=-10, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 2.5, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 2.5, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=4, hjust="inward")+
geom_text(aes(x=-10, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 3, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 3, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=4, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " -",sep="")),
size = 3, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 3, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=4, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " ;",sep="")),
size = 3, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 3, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
##### Data prep #####
#load library
library(MethComp)
#import data
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
##### Ciclo for: PB regression su tutti i parametri ed estrazione dei coefficienti della slope ####
slopes<-NULL
for(i in c(4:5)){
#set meth object
df_Meth<-Meth(df, 2,1,3,i)
df_Meth$meth<-factor(df_Meth$meth, levels=c("Procyte Idexx", "DF-50"))
#PB regression
reg<-PBreg(df_Meth)
#save slope coefficients and CI limits
coeff<-as.data.frame(reg[["coefficients"]])
varslope<- as.data.frame(coeff[2,])
row.names(varslope)<-colnames(df[i])
slopes<-rbind(slopes, varslope)
}
library(data.table)
setDT(slopes, keep.rownames = TRUE)[]
colnames(slopes)<-c("Parameter", "Estimate", "inf", "sup")
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=4, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " ;",sep="")),
size = 3, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 3, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
library(ggplot2)
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=4, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " ;",sep="")),
size = 3, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 3, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
#plot
ggplot(data=slopes, aes(x=Estimate, y=Parameter))+
geom_errorbarh(aes(xmin=inf, xmax=sup), color="darkgrey")+
geom_point(color="red")+
geom_vline(xintercept=0, color="blue")+
geom_text(aes(x=-15, y=Parameter,
label=paste("Estimate:", round(Estimate,2))),
size=4, hjust="inward")+
geom_text(aes(x=-8, y=Parameter,
label=paste("[ ",
round(inf,2), " ;",sep="")),
size = 3, hjust="inward")+
geom_text(aes(x=-6, y=Parameter,
label=paste(round(sup,2), " ]", sep="")),
size = 3, hjust="inward")+
scale_x_continuous(limits=c(-15,20))+
theme_bw()
varslope<- as.data.frame(coeff[2,])
coeff[2,]
View(coeff)
