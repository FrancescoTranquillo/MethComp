library(plotly)
library(ggplot2)
library(MethComp)
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
kable(head(df))
head(df)
df<-Meth(df, 2,1,3,4)
head(df)
df<-Meth(df, 2,1,3,4)
#RBC only
df<-df[,-c(5:25)]
#### Data Preparation ####
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
#RBC only
df<-df[,-c(5:25)]
View(df)
#delete ID column
df<-df[,-c(1)]
View(df)
melt(df)
library(reshape2)
melt(df)
mdf<-melt(df, df$methods)
df<-factor(df_Meth$meth, levels=c("Procyte Idexx", "DF-50"))
df<-factor(df$methods, levels=c("Procyte Idexx", "DF-50"))
#### Data Preparation ####
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
df$methods<-factor(df$methods, levels=c("Procyte Idexx", "DF-50"))
head(df)
#RBC only
df<-df[,-c(5:25)]
#delete ID column
df<-df[,-c(1)]
mdf<-melt(df, df$methods)
#### Data Preparation ####
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
#RBC only
df<-df[,-c(1, 5:25)]
library(dplyr)
filter(df, methods=="DF-50", replicate==1)
filter(df, methods=="DF-50", replicate==2)
filter(df, methods=="Procyte Idexx", replicate==1)
filter(df, methods=="Procyte Idexx", replicate==2)
new<-filter(df, methods=="DF-50", replicate==1)
new%>% unite(New_1, methods, replicate)
install.packages("tidyverse")
library(tidyverse)
new%>% unite(New_1, methods, replicate)
#### Data Preparation ####
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
#RBC only
df<-df[,-c(1, 5:25)]
new_1<-filter(df, methods=="DF-50", replicate==1)
%>% new_1[, -c(1,2)]
new_1<-new_1[, -c(1,2)]
#### Data Preparation ####
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
#RBC only
df<-df[,-c(1, 5:25)]
new_1<-df[df$methods=="DF-50", df$replicate=="1"]
new_1<-df[df$methods=="DF-50", df$replicate=="1",]
new_1<-df[df$methods=="DF-50", df$replicate=="1", df$RBC]
new_1<-df[df$methods=="DF-50", df$RBC]
new_1<-df[df$methods=="DF-50", ]
View(new_1)
#### Data Preparation ####
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
#RBC only
df<-df[,-c(1, 5:25)]
new_1<-df[df$methods=="DF-50", ]
View(new_1)
new_1<-df[df$methods=="DF-50"&&df$replicate=="1", ]
new_1<-df[df$methods=="DF-50"&&df$replicate==1, ]
#### Data Preparation ####
df<-read.csv("cani.csv", header = TRUE, sep = ";", dec= ",", stringsAsFactors = FALSE)
#delete record number 99
df<-df[-c(393:396),]
head(df)
#RBC only
df<-df[,-c(1, 5:25)]
new_1<-df[df$methods=="DF-50"&&df$replicate==1, ]
new_1<-df[df$methods=="DF-50" , ]
new_1<-df[ df$replicate==1, ]
new_1<-df[ df$replicate==1, ]
View(new_1)
new_1<-df[ df$replicate==1 & df$methods=="DF-50" , ]
View(new_1)
new_2<-df[df$methods=="DF-50" & df$replicate==2, ]
ref_1<-df[df$methods=="Procyte Idexx" & df$replicate==1, ]
ref_2<-df[df$methods=="Procyte Idexx" & df$replicate==2, ]
View(ref_2)
#creating new table
new_1<-df[df$methods=="DF-50" & df$replicate==1, df$RBC]
#creating new table
new_1<-df[df$methods=="DF-50" & df$replicate==1, df$RBC]
View(new_1)
#creating new table
new_1<-df[df$methods=="DF-50" & df$replicate==1, 3]
tab<-data.frame(new_1, new_2, ref_1, ref_2)
View(tab)
#creating new table
new_1<-df[df$methods=="DF-50" & df$replicate==1, 3]
new_2<-df[df$methods=="DF-50" & df$replicate==2, 3]
ref_1<-df[df$methods=="Procyte Idexx" & df$replicate==1, 3]
ref_2<-df[df$methods=="Procyte Idexx" & df$replicate==2, 3]
tab<-data.frame(new_1, new_2, ref_1, ref_2)
View(tab)
#creating new table which columns are composed by previous vectors
tab_rep<-data.frame(new_1, new_2, ref_1, ref_2)
#table without replicates
tab_norep<-data.frame(new_1, ref_1)
View(tab_norep)
plot(tab_norep$new_1, tab_norep$ref_1,
xlab= "RBC new method",
ylab= "RBC reference method"
)
fit.lm<- lm(tab_norep$ref_1 ~ tab_norep$ new_1)
plot(tab_norep$new_1, tab_norep$ref_1,
xlab= "RBC new method",
ylab= "RBC reference method"
)
cat("Adding the regression line:")
abline(a=fit.lm$coefficients[1], b=fit.lm$coefficients[2])
abline(a=0, b=1, lty=2)
CI_ex <- predict(fit.lm, interval="confidence")
colnames(CI_ex)<- c("fit_CI", "lwr_CI", "upr_CI")
PI_ex <- predict(fit.lm, interval="prediction")
colnames(PI_ex)<- c("fit_PI", "lwr_PI", "upr_PI")
View(CI_ex)
ggplot(tab_norep)
ggplot(tab_norep)+
geom_point()
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))
abline(a=fit.lm$coefficients[1], b=fit.lm$coefficients[2])
+geom_abline(fit.lm$coefficients[1], fit.lm$coefficients[2])
+geom_abline(tab_norep, fit.lm$coefficients[1], fit.lm$coefficients[2])
+geom_abline(slope=fit.lm$coefficients[1], intercept=fit.lm$coefficients[2])
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1)
#Adding the regression line#
+geom_abline(slope=fit.lm$coefficients[1], intercept=fit.lm$coefficients[2])
)
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1)
#Adding the regression line#
+geom_abline(slope=fit.lm$coefficients[1], intercept=fit.lm$coefficients[2])
)
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1)
#Adding the regression line#
+geom_abline(slope=fit.lm$coefficients[1], intercept=fit.lm$coefficients[2])
)
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red")
#Adding the regression line#
+geom_abline(slope=fit.lm$coefficients[1], intercept=fit.lm$coefficients[2])
)
ggplot(tab_norep)+
# geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red")
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[1], intercept=fit.lm$coefficients[2])
ggplot(tab_norep)+
# geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red")
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[1], intercept=fit.lm$coefficients[2])
ggplot(tab_norep)+
# geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red")
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red")
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])
)
ggplot(tab_norep)
+ geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red")
#Adding the regression line#
+geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])
)
+geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red"))
+geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])
ggplot(tab_norep)
+geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red"))
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red"))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
geom_abline(slope=1, intercept=0
)
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
geom_abline(slope=1, intercept=0, color="blue"
)
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
geom_abline(slope=1, intercept=0, color="blue", text="id"
)
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
geom_abline(slope=1, intercept=0, color="blue", labels.default()="id"
)
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
ggplotly(p)
var_results<-cbind(tab_norep,CI_ex, PI_ex)
View(var_results)
ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p+
geom_abline(var_results$lwr_PI)
p+
geom_abline(aes(var_results$lwr_PI), color="red")
p+
geom_abline(data=var_results$new_1)
geom_abline(var_results
p+
geom_abline(var_results, color="red")
p+
geom_abline(var_results, aes(color="red"))
p+
geom_line(var_results$new_1, var_results$fit_CI)
p+
geom_line(var_results$fit_CI)
p+
geom_line(aes(var_results$fit_CI))
p+
geom_line(aes(var_results$new_1, var_results$fit_CI))
p+
geom_line(aes(var_results$new_1, var_results$fit_CI))+
geom_line(aes(var_results$new_1, var_results$lwr_CI))+
p+
geom_line(aes(var_results$new_1, var_results$fit_CI))+
geom_line(aes(var_results$new_1, var_results$lwr_CI))+
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p
CI_ex <- predict(fit.lm, interval="confidence")
colnames(CI_ex)<- c("fit_CI", "lwr_CI", "upr_CI")
#prediction interval for the linear regression:
PI_ex <- predict(fit.lm, interval="prediction")
colnames(PI_ex)<- c("fit_PI", "lwr_PI", "upr_PI")
#storing and plotting of the intervals:
var_results<-cbind(tab_norep,CI_ex, PI_ex)
p+
geom_line(aes(var_results$new_1, var_results$fit_CI))+
geom_line(aes(var_results$new_1, var_results$lwr_CI))+
p+
geom_line(aes(var_results$new_1, var_results$fit_CI))+
geom_line(aes(var_results$new_1, var_results$lwr_CI))+
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
theme_classic()
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
theme_classic()
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
theme_classic()
p
p+
geom_line(aes(x=var_results$new_1, y=var_results$fit_CI))+
geom_line(aes(var_results$new_1, var_results$lwr_CI))+
p+
geom_line(aes(x=var_results$new_1, y=var_results$fit_CI))+
geom_line(aes(var_results$new_1, var_results$lwr_CI))+
p+
geom_line(aes(x=var_results$new_1, y=var_results$fit_CI))+
)  geom_line(aes(var_results$new_1, var_results$lwr_CI))+
p
var_results<-var_results[order(var_results$new_1)]
var_results<-var_results[order(var_results$new_1),]
View(var_results)
ggplot(var_results)
+geom_abline()
ggplot(var_results)+ geom_abline()
ggplot(var_results)+ geom_abline()+ geom_point()
p+
qplot(x=var_results$new_1, y=var_results$fit_CI)
p+
qplot(x=var_results$new_1, y=var_results$fit_CI)
p+
qplot(x=var_results$new_1, y=var_results$fit_CI)
qplot(x=var_results$new_1, y=var_results$fit_CI)
p+  qplot(x=var_results$new_1, y=var_results$fit_CI)
qplot(x=var_results$new_1, y=var_results$lwr_CI)
qplot(x=var_results$new_1, y=var_results$sup_CI)
qplot(x=var_results$new_1, y=var_results$upr_CI)
qplot(x=var_results$new_1, y=var_results$fit_CI)
+qplot(x=var_results$new_1, y=var_results$lwr_CI)
qplot(x=var_results$new_1, y=var_results$fit_CI)+ qplot(x=var_results$new_1, y=var_results$lwr_CI)
plot(tab_norep$new_1, tab_norep$ref_1,
xlab= "RBC new method",
ylab= "RBC reference method"
)
lines(x=var_results$new_1, y=var_results$lwr_PI)
lines(x=var_results$new_1, y=var_results$upr_PI)
lines(x=var_results$new_1, y=var_results$fit_PI)
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
theme_classic()
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
theme_classic()
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
theme_classic()
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
theme_classic()
p
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")+
p
p<-ggplot(tab_norep)+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p
p<-ggplot(tab_norep, aes(x="new"))+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p
p<-ggplot(tab_norep, aes(x="new", y=tab_norep$ref_1))+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p
p<-ggplot(tab_norep, aes(x="new", y="tab_norep$ref_1"))+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p
p<-ggplot(tab_norep, aes_string(x="new", y="tab_norep$ref_1"))+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p
p<-ggplot(tab_norep, aes_string(x="new", y="ref"))+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p
View(var_results)
View(tab_norep)
library(reshape2)
melt<-melt(var_results)
View(melt)
ggplot(var_results)
ggplot(var_results)+
geom_point()
View(melt)
melt<-melt(var_results, var_results$new_1)
View(melt)
melt<-melt(var_results, var=var_results$new_1)
melt<-melt(var_results, var="var_results$new_1")
View(melt)
melt<-melt(var_results, var=c(var_results$new_1))
melt<-melt(var_results, var=c("var_results$new_1", "var_results$ref_1"))
plot(tab_norep$new_1, tab_norep$ref_1,
xlab= "RBC new method",
ylab= "RBC reference method"
)
lines(x=var_results$new_1, y=var_results$lwr_PI)
lines(x=var_results$new_1, y=var_results$upr_PI)
lines(x=var_results$new_1, y=var_results$fit_PI)
p
+
geom_line(data=var_results$lwr_PI)
geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI))
p
p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI))
p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI, color ="red"))
p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI))
p+  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$upr_PI))
p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI))
+  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$upr_PI))
p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI)) +
geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$upr_PI))
plot(tab_norep$new_1, tab_norep$ref_1,
xlab= "RBC new method",
ylab= "RBC reference method"
)
lines(x=var_results$new_1, y=var_results$lwr_PI)
lines(x=var_results$new_1, y=var_results$upr_PI)
lines(x=var_results$new_1, y=var_results$fit_PI)
p<-ggplot(tab_norep, aes_string(x="new", y="ref"))+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI)) +
geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$upr_PI))
CI_ex <- predict(fit.lm, interval="confidence")
p<-p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI)) +
geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$upr_PI))
ggplotly(p)
p<-ggplot(tab_norep, aes_string(x="new", y="ref"))+
geom_point(aes(tab_norep$new_1, tab_norep$ref_1, color="red"))+
#Adding the regression line#
geom_abline(slope=fit.lm$coefficients[2], intercept=fit.lm$coefficients[1])+
#Adding the identity line
geom_abline(slope=1, intercept=0, color="blue")
p<-p +  geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$lwr_PI)) +
geom_line(data=var_results, aes(x=var_results$new_1, y=var_results$upr_PI))
ggplotly(p)
